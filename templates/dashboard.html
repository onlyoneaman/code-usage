<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Code Usage Dashboard</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:#f8fafc;color:#334155;line-height:1.6}.header{border-bottom:1px solid #e2e8f0}.header-inner{max-width:1100px;margin:0 auto;padding:24px 24px 0}.header-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.header h1{font-size:24px;font-weight:700;color:#0f172a}.header .sub{font-size:13px;color:#64748b;margin-top:4px}.header .gen-time{font-size:11px;color:#94a3b8;text-align:right}.header-meta{text-align:right}.header-links{font-size:11px;margin-top:4px}.header-links a{color:#94a3b8;text-decoration:none;font-weight:500}.header-links a:hover{color:#64748b;text-decoration:underline}.header-links .link-dot{color:#cbd5e1;margin:0 4px}.container{max-width:1100px;margin:0 auto;padding:24px}.header-controls{display:flex;justify-content:space-between;align-items:flex-end;gap:12px}.tab-bar{display:flex;gap:4px;margin:0;background:#e2e8f0;border-radius:10px 10px 0 0;padding:4px 4px 0;width:fit-content}.tab-btn{padding:8px 20px 10px;border-radius:8px 8px 0 0;border:none;background:0 0;font-size:13px;font-weight:600;color:#64748b;cursor:pointer;transition:.2s;display:inline-flex;align-items:center;gap:7px}.tab-icon{width:15px;height:15px;object-fit:contain;flex:0 0 auto}.tab-btn:hover{color:#334155}.tab-btn.active[data-tab=all]{background:#f8fafc;color:#3b82f6;box-shadow:none;border-bottom:2px solid #3b82f6}.tab-btn.active[data-tab=claude]{background:#f8fafc;color:#d37356;box-shadow:none;border-bottom:2px solid #d37356}.tab-btn.active[data-tab=codex]{background:#f8fafc;color:#7385fe;box-shadow:none;border-bottom:2px solid #7385fe}.range-control{display:flex;align-items:center;gap:8px;margin-bottom:6px}.range-label{font-size:12px;color:#64748b;font-weight:600;white-space:nowrap}.range-select{border:1px solid #cbd5e1;background:#fff;border-radius:8px;padding:6px 10px;font-size:12px;color:#0f172a;font-weight:600}.daily-view-toggle{display:inline-flex;gap:4px;background:#e2e8f0;border-radius:8px;padding:3px}.daily-view-btn{border:none;background:0 0;color:#64748b;font-size:12px;font-weight:600;padding:5px 10px;border-radius:6px;cursor:pointer}.daily-view-btn.active{background:#fff;color:#0f172a;box-shadow:0 1px 2px rgba(0,0,0,.08)}.tab-panel{display:none}.tab-panel.active{display:block}.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:28px}.stat-card{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:20px;box-shadow:0 1px 3px rgba(0,0,0,.04)}.stat-label{font-size:11px;text-transform:uppercase;letter-spacing:.05em;color:#94a3b8;margin-bottom:6px}.stat-value{font-size:28px;font-weight:700;color:#0f172a}.stat-value.cost{color:var(--accent,#d37356)}.stat-sub{font-size:12px;color:#94a3b8;margin-top:2px}.section{margin-bottom:28px}.section h2{font-size:16px;font-weight:600;color:#1e293b;margin-bottom:14px;padding-bottom:8px;border-bottom:1px solid #e2e8f0}table{width:100%;border-collapse:collapse;font-size:13px}th{text-align:left;padding:10px 14px;color:#94a3b8;font-weight:600;font-size:11px;text-transform:uppercase;letter-spacing:.05em;border-bottom:2px solid #e2e8f0}th.r{text-align:right}td{padding:10px 14px;border-bottom:1px solid #f1f5f9;color:#475569}tr:hover td{background:#f8fafc}td.num{text-align:right;font-variant-numeric:tabular-nums}td.cost-cell{font-weight:600;text-align:right;font-variant-numeric:tabular-nums}.model-tag{display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600}.model-opus{background:#f9e8e3;color:#a8533a}.model-sonnet{background:#fdf1ec;color:#c47a5f}.model-haiku{background:#d1fae5;color:#047857}.model-codex{background:#e3e8fe;color:#4a5fc7}.proj-wrap{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:24px;box-shadow:0 1px 3px rgba(0,0,0,.04);display:flex;align-items:center;gap:32px}.proj-donut{width:160px;height:160px;border-radius:50%;position:relative;flex-shrink:0}.proj-donut-hole{position:absolute;top:50%;left:50%;width:90px;height:90px;background:#fff;border-radius:50%;transform:translate(-50%,-50%)}.proj-legend{flex:1;min-width:0}.proj-legend-row,.proj-more-row{display:flex;align-items:center;gap:10px;padding:6px 0}.proj-swatch{width:10px;height:10px;border-radius:3px;flex-shrink:0}.proj-legend-name{font-size:13px;font-weight:600;color:#1e293b;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.proj-legend-meta{display:flex;gap:10px;align-items:baseline;white-space:nowrap}.proj-cost{font-size:13px;font-weight:700;color:#0f172a;font-variant-numeric:tabular-nums}.proj-sessions{font-size:12px;color:#94a3b8}.proj-toggle{background:0 0;border:none;color:#64748b;font-size:12px;font-weight:600;cursor:pointer;padding:8px 0 0}.proj-toggle:hover{color:#334155}.proj-more-list{border-top:1px solid #f1f5f9;margin-top:4px;padding-top:4px}@media (max-width:768px){.proj-wrap{flex-direction:column;align-items:stretch}.proj-donut{margin:0 auto}}.chart-container{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:40px 20px 20px;box-shadow:0 1px 3px rgba(0,0,0,.04);overflow:visible}.bar-chart{display:flex;align-items:flex-end;gap:3px;height:160px;position:relative}.bar-group{display:flex;flex-direction:column;align-items:center;flex:1;min-width:18px}.bar{width:100%;min-width:12px;max-width:28px;border-radius:3px 3px 0 0;transition:background .2s;cursor:pointer;position:relative}.bar:hover{filter:brightness(.9)}.bar-label{font-size:9px;color:#94a3b8;margin-top:6px;writing-mode:vertical-lr;text-orientation:mixed;transform:rotate(180deg);max-height:50px;overflow:hidden}.tooltip{display:none;position:absolute;bottom:calc(100% + 8px);left:50%;transform:translateX(-50%);background:#1e293b;color:#f1f5f9;padding:8px 12px;border-radius:6px;font-size:11px;white-space:pre-line;min-width:170px;max-width:280px;line-height:1.35;text-align:left;z-index:9999;pointer-events:none;box-shadow:0 4px 12px rgba(0,0,0,.15)}.chart-legend{display:flex;gap:14px;margin-bottom:8px;justify-content:flex-end;font-size:11px;color:#64748b}.chart-legend .swatch{display:inline-block;width:10px;height:10px;border-radius:2px;margin-right:4px;vertical-align:middle}.bar:hover .tooltip{display:block}.weekly-chart{display:flex;align-items:flex-end;gap:12px;height:160px;justify-content:center;position:relative}.weekly-chart .bar-group{display:flex;flex-direction:column;align-items:center;flex:1;max-width:120px}.weekly-chart .bar{width:100%;max-width:120px;min-width:40px;border-radius:6px 6px 0 0;transition:background .2s;cursor:pointer;position:relative}.weekly-chart .bar-label{font-size:11px;color:#64748b;margin-top:8px;writing-mode:horizontal-tb;transform:none;text-align:center;max-height:none;font-weight:500}.weekly-chart .bar-cost{font-size:11px;font-weight:600;margin-bottom:4px}.pricing-note{font-size:12px;color:#94a3b8;margin-top:16px;padding:12px;background:#fff;border-radius:8px;border:1px solid #e2e8f0}.model-usage-list{background:#fff;border:1px solid #e2e8f0;border-radius:12px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.04)}.mu-row{display:flex;align-items:center;padding:12px 16px;border-bottom:1px solid #f1f5f9}.mu-row:last-child{border-bottom:none}.mu-left{display:flex;align-items:center;gap:8px;min-width:240px}.mu-right{display:flex;align-items:center;gap:12px;flex:1}.mu-bar{height:8px;border-radius:4px;min-width:2px}.mu-cost{font-size:14px;font-weight:700;color:#0f172a;font-variant-numeric:tabular-nums;white-space:nowrap}.no-data{text-align:center;padding:80px 24px;color:#94a3b8}.no-data h3{font-size:18px;color:#64748b;margin-bottom:8px}.no-data a{color:var(--accent,#d37356)}.footer{text-align:center;margin-top:24px;padding:20px 0 8px;font-size:13px;color:#94a3b8}.footer code{background:#e2e8f0;padding:2px 6px;border-radius:4px;font-size:12px;color:#64748b}.footer a{color:#334155;text-decoration:none;font-weight:600}.footer a:hover{text-decoration:underline}.footer p{margin:4px 0}.freshness-banner{background:#fff;border:1px solid #e2e8f0;border-radius:8px;padding:12px 16px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;font-size:13px;box-shadow:0 1px 3px rgba(0,0,0,.04)}.freshness-banner .date-info{color:#64748b}.freshness-banner .date-val{color:#0f172a;font-weight:600}.sub-badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-left:6px;vertical-align:middle}.sub-badge.claude{background:#f9e8e3;color:#a8533a}.sub-badge.codex{background:#e3e8fe;color:#4a5fc7}@media (max-width:768px){.header-inner{padding:16px 16px 0}.header-controls{flex-direction:column;align-items:stretch}.tab-bar{width:100%;justify-content:space-between}.tab-btn{flex:1;text-align:center;padding:8px 8px 10px;justify-content:center}.range-control{justify-content:flex-start;margin-bottom:10px}.stats-grid{grid-template-columns:repeat(2,1fr)}.container{padding:16px}}
</style>
</head>
<body>
<div class="header">
  <div class="header-inner">
    <div class="header-top">
      <div>
        <h1>Code Usage Dashboard</h1>
        <div class="sub">See how much your AI coding actually costs.</div>
      </div>
      <div class="header-meta">
        <div class="gen-time" id="gen-time"></div>
        <div class="header-links">
          <a href="https://www.npmjs.com/package/code-usage" target="_blank" rel="noopener">npm</a>
          <span class="link-dot">&middot;</span>
          <a href="https://github.com/onlyoneaman/code-usage" target="_blank" rel="noopener">GitHub</a>
        </div>
      </div>
    </div>
    <div class="header-controls">
      <div class="tab-bar" id="tab-bar"></div>
      <div class="range-control">
        <label class="range-label" for="range-select">Range</label>
        <select class="range-select" id="range-select"></select>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div id="panel-all" class="tab-panel"></div>
  <div id="panel-claude" class="tab-panel"></div>
  <div id="panel-codex" class="tab-panel"></div>
  <div class="footer">
    <p>Run <code>code-usage</code> to generate a fresh report.</p>
    <p id="footer-meta"></p>
  </div>
</div>
<script>
// DATA_PLACEHOLDER
function fmt(e){return e>=1e9?(e/1e9).toFixed(1)+"B":e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":String(e)}function fmtUSD(e){return"$"+e.toFixed(2)}function pad2(e){return e<10?"0"+e:String(e)}function localDateStr(e){return e.getFullYear()+"-"+pad2(e.getMonth()+1)+"-"+pad2(e.getDate())}function fullDateStr(e){var a=String(e||"").match(/^(\d{4})-(\d{2})-(\d{2})$/);return a?a[2]+"-"+a[3]+"-"+a[1]:String(e||"")}function fullDateFromIso(e){if(!e)return"-";var a=new Date(e);return Number.isNaN(a.getTime())?String(e):pad2(a.getMonth()+1)+"-"+pad2(a.getDate())+"-"+a.getFullYear()}function modelUsageKey(e){return String(e||"").replace(/-\d{8}$/,"")}function toFileUrl(e){var a=String(e||"").replace(/\\/g,"/");return a?0===a.indexOf("file://")||0===a.indexOf("http://")||0===a.indexOf("https://")?a:"/"===a.charAt(0)?"file://"+a:"file:///"+a:""}function providerFromModel(e){return String(e||"").startsWith("gpt-")?"codex":"claude"}function colorForModel(e){var a=String(e||"").toLowerCase();return a.startsWith("gpt-")?CODEX_COLOR:-1!==a.indexOf("haiku")?"#047857":-1!==a.indexOf("sonnet")?"#c47a5f":CLAUDE_COLOR}function rowAgentCosts(e){var a=0,t=0,s=e&&e.modelCosts?e.modelCosts:null;if(s)for(var o in s)"codex"===providerFromModel(o)?t+=s[o]||0:a+=s[o]||0;return{claude:a,codex:t}}var MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function el(e,a,t){var s=document.createElement(e);if(a)for(var o in a)"class"===o?s.className=a[o]:"style"===o?s.style.cssText=a[o]:s.setAttribute(o,a[o]);return t&&("string"==typeof t?s.textContent=t:Array.isArray(t)?t.forEach(function(e){e&&s.appendChild(e)}):s.appendChild(t)),s}function createStatCard(e,a,t,s){var o=el("div",{class:"stat-card"});return o.appendChild(el("div",{class:"stat-label"},e)),o.appendChild(el("div",{class:"stat-value"+(t?" "+t:"")},a)),s&&o.appendChild(el("div",{class:"stat-sub"},s)),o}function renderFooter(){var e=document.getElementById("footer-meta");if(e){var a="undefined"!=typeof DATA&&DATA&&DATA.appMeta?DATA.appMeta:{},t=a.authorName||"Aman",s=a.authorUrl||"https://x.com/onlyoneaman",o=a.repoUrl||"https://github.com/onlyoneaman/code-usage",n=a.packageUrl||"https://www.npmjs.com/package/code-usage",l=a.name||"code-usage",d=a.version||"";e.textContent="",e.appendChild(document.createTextNode("Made with ❤️ by ")),e.appendChild(el("a",{href:s,target:"_blank",rel:"noopener noreferrer"},t)),d&&e.appendChild(document.createTextNode(" · v"+d)),e.appendChild(document.createTextNode(" · ")),e.appendChild(el("a",{href:o,target:"_blank",rel:"noopener noreferrer"},"GitHub")),e.appendChild(document.createTextNode(" · ")),e.appendChild(el("a",{href:n,target:"_blank",rel:"noopener noreferrer"},l))}}var MODEL_ORDER=["opus-4-6","opus-4-5","opus-4-1","opus-4","sonnet-4-5","sonnet-4","sonnet-3-7","haiku-4-5","haiku-3-5","gpt-5.3","gpt-5.2","gpt-5.1","gpt-5-codex"];function modelSortKey(e){for(var a=0;a<MODEL_ORDER.length;a++)if(e.includes(MODEL_ORDER[a]))return a;return 99}function createModelTag(e){if(e.startsWith("gpt-"))return el("span",{class:"model-tag model-codex"},e);var a=e.replace("claude-","").replace(/-\d{8}$/,""),t=a.split("-");a=t[0].charAt(0).toUpperCase()+t[0].slice(1)+" "+t.slice(1).join(".");var s="model-tag model-sonnet";return e.includes("opus")?s="model-tag model-opus":e.includes("haiku")&&(s="model-tag model-haiku"),el("span",{class:s},a)}function getWeekStart(e){var a=new Date(e+"T12:00:00"),t=a.getDay(),s=0===t?6:t-1;return a.setDate(a.getDate()-s),localDateStr(a)}function weekLabel(e){var a=new Date(e+"T12:00:00"),t=new Date(a);return t.setDate(t.getDate()+6),a.getMonth()===t.getMonth()?MONTHS[a.getMonth()]+" "+a.getDate()+"-"+t.getDate():MONTHS[a.getMonth()]+" "+a.getDate()+" - "+MONTHS[t.getMonth()]+" "+t.getDate()}function sumBy(e,a){return e.reduce(function(e,t){return e+(t[a]||0)},0)}function buildOpts(e){var a=e.summary,t=e.accent,s=e.daily.length,o=s>0?a.totalCost/s:0,n=a.totalSessions>0?a.totalCost/a.totalSessions:0,l=a.firstDate?new Date(a.firstDate):new Date,d=localDateStr(new Date),r={};e.daily.forEach(function(e){r[e.date]=e});for(var i=[],c=new Date(l);localDateStr(c)<=d;){var p=localDateStr(c);i.push(r[p]||{date:p,cost:0,sessions:0,messages:0,models:[]}),c.setDate(c.getDate()+1)}var u=1;i.forEach(function(e){e.messages>u&&(u=e.messages)});var h={};e.daily.forEach(function(e){var a=getWeekStart(e.date);h[a]||(h[a]={cost:0,sessions:0}),h[a].cost+=e.cost,h[a].sessions+=e.sessions});var C=Object.keys(h).sort(),f=e.daily.slice().reverse(),g=[];e.extra&&((e.extra.linesAdded||e.extra.linesRemoved)&&g.push(createStatCard("Lines","+"+fmt(e.extra.linesAdded||0)+" / -"+fmt(e.extra.linesRemoved||0))),e.extra.filesModified&&g.push(createStatCard("Files Modified",fmt(e.extra.filesModified))));var m=[];if(e.badge){var v=el("span",{class:"sub-badge "+("claude"===e.provider?"claude":"codex")});v.textContent=e.badge,m.push(el("span",{class:"date-info"},[v]))}var y=e.models.map(function(a){return{id:a.id,cost:a.cost,provider:e.provider}}),D=y.slice().sort(function(e,a){return a.cost-e.cost}),b=(e.projects||[]).map(function(a){return{name:a.name,path:a.path,sessions:a.sessions,messages:a.messages,cost:a.cost,daily:a.daily,provider:e.provider}});return{accent:t,displayCost:a.totalCost,daysActive:s,totalSessions:a.totalSessions,costPerDay:o,costPerSession:n,streak:a.streak,userMessages:a.totalMessages,outputTokens:a.totalOutputTokens,firstDate:a.firstDate,allDays:i,maxMsg:u,rawModels:y,modelUsage:D,showProviderBadge:!1,weeklySorted:C,weeklyMap:h,dailyRows:f,extraCards:g,badgeEls:m,pricingNote:e.pricingNote,projects:b}}function mergeOpts(e,a){if(!e)return adjustAccent(a);if(!a)return adjustAccent(e);var t=e.displayCost+a.displayCost,s=e.totalSessions+a.totalSessions,o=e.userMessages+a.userMessages,n=e.outputTokens+a.outputTokens,l={},d={};e.allDays.forEach(function(e){l[e.date]=e}),a.allDays.forEach(function(e){d[e.date]=e});var r={};function i(e){e.forEach(function(e){r[e.date]||(r[e.date]={date:e.date,cost:0,sessions:0,messages:0}),r[e.date].cost+=e.cost,r[e.date].sessions+=e.sessions,r[e.date].messages+=e.messages})}i(e.allDays),i(a.allDays);var c=Object.keys(r).sort(),p=c.length?c[0]+"T00:00:00.000Z":null,u=new Date,h=localDateStr(u),C=[],f={cost:0,sessions:0,messages:0};if(c.length)for(var g=new Date(c[0]+"T12:00:00");localDateStr(g)<=h;){var m=localDateStr(g),v=r[m]||{date:m,cost:0,sessions:0,messages:0},y=l[m]||f,D=d[m]||f;v.claudeCost=y.cost||0,v.codexCost=D.cost||0,v.claudeMsg=y.messages||0,v.codexMsg=D.messages||0,v.claudeSess=y.sessions||0,v.codexSess=D.sessions||0,C.push(v),g.setDate(g.getDate()+1)}var b=1;C.forEach(function(e){e.messages>b&&(b=e.messages)});var x=C.filter(function(e){return e.sessions>0}).length,S={};C.forEach(function(e){e.sessions>0&&(S[e.date]=!0)});for(var w=0,k=new Date(u);S[localDateStr(k)];)w++,k.setDate(k.getDate()-1);var O=e.weeklyMap||{},E=a.weeklyMap||{},M={};function A(e){for(var a in e)M[a]||(M[a]={cost:0,sessions:0,claudeCost:0,codexCost:0}),M[a].cost+=e[a].cost,M[a].sessions+=e[a].sessions}for(var j in A(e.weeklyMap),A(a.weeklyMap),O)M[j]&&(M[j].claudeCost+=O[j].cost);for(var T in E)M[T]&&(M[T].codexCost+=E[T].cost);var L=Object.keys(M).sort(),U={};function R(e){e.forEach(function(e){if(U[e.date]||(U[e.date]={date:e.date,cost:0,sessions:0,messages:0,models:[],modelCosts:{}}),U[e.date].cost+=e.cost,U[e.date].sessions+=e.sessions,U[e.date].messages+=e.messages,e.modelCosts)for(var a in e.modelCosts)U[e.date].modelCosts[a]=(U[e.date].modelCosts[a]||0)+(e.modelCosts[a]||0);e.models&&e.models.forEach(function(a){-1===U[e.date].models.indexOf(a)&&U[e.date].models.push(a)})})}R(e.dailyRows),R(a.dailyRows);var _=Object.keys(U).sort().reverse().map(function(e){var a=U[e];return a.modelCosts&&(a.models=Object.keys(a.modelCosts).sort(function(e,t){var s=a.modelCosts[e]||0,o=a.modelCosts[t]||0;return s!==o?o-s:e.localeCompare(t)})),a}),N=[];function B(e,a,t){var s=el("span",{class:"date-info"}),o=el("span",{class:"sub-badge "+t});return o.textContent=e+" "+a,s.appendChild(o),s}N.push(B("Claude",e.totalSessions,"claude")),N.push(B("Codex",a.totalSessions,"codex"));var P=[].concat(e.rawModels||[]).concat(a.rawModels||[]);P.sort(function(e,a){return a.cost-e.cost});var F={};function I(e,a){(e||[]).forEach(function(e){F[e.name]||(F[e.name]={name:e.name,path:e.path,sessions:0,messages:0,cost:0,claudeCost:0,codexCost:0,daily:{}}),F[e.name].sessions+=e.sessions,F[e.name].messages+=e.messages,F[e.name].cost+=e.cost,"claude"===a?F[e.name].claudeCost+=e.cost:F[e.name].codexCost+=e.cost,(e.daily||[]).forEach(function(t){F[e.name].daily[t.date]||(F[e.name].daily[t.date]={sessions:0,messages:0,cost:0,claudeCost:0,codexCost:0}),F[e.name].daily[t.date].sessions+=t.sessions,F[e.name].daily[t.date].messages+=t.messages,F[e.name].daily[t.date].cost+=t.cost,"claude"===a?F[e.name].daily[t.date].claudeCost+=t.cost:F[e.name].daily[t.date].codexCost+=t.cost})})}I(e.projects,"claude"),I(a.projects,"codex");var W=Object.keys(F).map(function(e){var a=F[e];return a.daily=Object.keys(a.daily).sort().map(function(e){var t=a.daily[e];return{date:e,sessions:t.sessions,messages:t.messages,cost:t.cost,claudeCost:t.claudeCost,codexCost:t.codexCost}}),a}).sort(function(e,a){return a.cost-e.cost});return{accent:"#3b82f6",displayCost:t,daysActive:x,totalSessions:s,costPerDay:x>0?t/x:0,costPerSession:s>0?t/s:0,streak:w,userMessages:o,outputTokens:n,firstDate:p,allDays:C,maxMsg:b,stacked:!0,modelUsage:P,showProviderBadge:!0,weeklySorted:L,weeklyMap:M,dailyRows:_,extraCards:[],badgeEls:N,pricingNote:"Combined view across Claude and Codex. Models are sorted by estimated cost usage.",projects:W}}function adjustAccent(e){var a=Object.assign({},e);return a.accent="#3b82f6",a}var RANGE_OPTIONS=[{id:"this_week",label:"This Week"},{id:"this_month",label:"This Month"},{id:"this_year",label:"This Year"},{id:"last_30_days",label:"Last 30 Days"},{id:"last_90_days",label:"Last 90 Days"},{id:"all_time",label:"All Time"}];function rangeStart(e){var a=new Date,t=new Date(a.getFullYear(),a.getMonth(),a.getDate());if("this_week"===e){var s=t.getDay(),o=0===s?6:s-1;return t.setDate(t.getDate()-o),localDateStr(t)}return"this_month"===e?(t.setDate(1),localDateStr(t)):"this_year"===e?(t.setMonth(0,1),localDateStr(t)):"last_30_days"===e?(t.setDate(t.getDate()-29),localDateStr(t)):"last_90_days"===e?(t.setDate(t.getDate()-89),localDateStr(t)):null}function computeStreak(e){var a={};e.forEach(function(e){e.sessions>0&&(a[e.date]=!0)});for(var t=0,s=new Date;a[localDateStr(s)];)t++,s.setDate(s.getDate()-1);return t}function applyRange(e,a){if(!e)return e;if("all_time"===a){var t=Object.assign({},e);return t.rangeId=a,t.projects=e.projects||[],t}var s=rangeStart(a),o=(e.allDays||[]).filter(function(e){return e.date>=s}),n=(e.dailyRows||[]).filter(function(e){return e.date>=s}),l=sumBy(o,"cost"),d=sumBy(o,"sessions"),r=Math.max(0,e.userMessages||0),i=sumBy(e.allDays||[],"messages"),c=sumBy(o,"messages"),p=r;r>0&&i>0&&(p=Math.round(r*(c/i)));for(var u=o.filter(function(e){return e.sessions>0}).length,h=null,C=0;C<o.length;C++)if(o[C].sessions>0){h=o[C].date+"T00:00:00.000Z";break}var f=1;o.forEach(function(e){e.messages>f&&(f=e.messages)});var g={};o.forEach(function(e){var a=getWeekStart(e.date);g[a]||(g[a]={cost:0,sessions:0,claudeCost:0,codexCost:0}),g[a].cost+=e.cost||0,g[a].sessions+=e.sessions||0,g[a].claudeCost+=e.claudeCost||0,g[a].codexCost+=e.codexCost||0});var m=Object.keys(g).sort(),v=e.modelUsage&&e.modelUsage.length?e.modelUsage:e.rawModels||[],y=(e.displayCost||0)>0?l/e.displayCost:0,D=v.map(function(e){return{id:e.id,cost:(e.cost||0)*y,provider:e.provider}}).filter(function(e){return e.cost>0}).sort(function(e,a){return a.cost-e.cost}),b=Object.assign({},e,{rangeId:a,allDays:o,maxMsg:f,dailyRows:n,weeklyMap:g,weeklySorted:m,displayCost:l,totalSessions:d,userMessages:p,daysActive:u,firstDate:h,costPerDay:u>0?l/u:0,costPerSession:d>0?l/d:0,streak:computeStreak(o),modelUsage:D});if(b.stacked){var x=sumBy(o,"claudeSess"),S=sumBy(o,"codexSess"),w=[];function k(e,a,t){var s=el("span",{class:"date-info"}),o=el("span",{class:"sub-badge "+t});return o.textContent=e+" "+a,s.appendChild(o),s}w.push(k("Claude",x,"claude")),w.push(k("Codex",S,"codex")),b.badgeEls=w}var O=(e.projects||[]).map(function(e){var a=(e.daily||[]).filter(function(e){return e.date>=s});if(0===a.length)return null;var t={name:e.name,path:e.path,daily:a,provider:e.provider,sessions:sumBy(a,"sessions"),messages:sumBy(a,"messages"),cost:sumBy(a,"cost")};return void 0!==e.claudeCost&&(t.claudeCost=sumBy(a,"claudeCost"),t.codexCost=sumBy(a,"codexCost")),t}).filter(function(e){return e&&e.sessions>0}).sort(function(e,a){return a.cost-e.cost});return b.projects=O,b.pricingNote="Models are sorted by estimated cost usage for this selected range.",b}var CLAUDE_COLOR="#D37356",CODEX_COLOR="#7385FE";function makeLegend(){var e=el("div",{class:"chart-legend"}),a=el("span");a.appendChild(el("span",{class:"swatch",style:"background:"+CLAUDE_COLOR})),a.appendChild(document.createTextNode("Claude")),e.appendChild(a);var t=el("span");return t.appendChild(el("span",{class:"swatch",style:"background:"+CODEX_COLOR})),t.appendChild(document.createTextNode("Codex")),e.appendChild(t),e}function renderBarChart(e,a,t,s,o){e.textContent="",a.forEach(function(a){var n=0===a.sessions,l=n?0:Math.max(4,a.messages/t*140),d=el("div",{class:"bar-group"}),r=s;if(o&&!n&&a.cost>0){var i=a.claudeCost/a.cost*100;r="linear-gradient(to top, "+CLAUDE_COLOR+" "+i+"%, "+CODEX_COLOR+" "+i+"%)"}var c=el("div",{class:"bar",style:"height:"+(n?"2":l)+"px;background:"+(n?"#e2e8f0":r)+";"}),p=fullDateStr(a.date)+" | "+fmtUSD(a.cost);p+=o?"\nClaude "+fmtUSD(a.claudeCost||0)+"\nCodex "+fmtUSD(a.codexCost||0):", "+a.sessions+" sessions",c.appendChild(el("div",{class:"tooltip"},p)),d.appendChild(c),d.appendChild(el("div",{class:"bar-label"},a.date.slice(5))),e.appendChild(d)})}function renderWeeklyChart(e,a,t,s,o){e.textContent="";var n=1;a.forEach(function(e){t[e].cost>n&&(n=t[e].cost)}),a.forEach(function(a){var l=t[a],d=Math.max(8,l.cost/n*130),r=el("div",{class:"bar-group"});r.appendChild(el("div",{class:"bar-cost",style:"color:"+s},fmtUSD(l.cost)));var i=s;if(o&&l.cost>0){var c=l.claudeCost/l.cost*100;i="linear-gradient(to top, "+CLAUDE_COLOR+" "+c+"%, "+CODEX_COLOR+" "+c+"%)"}var p=el("div",{class:"bar",style:"height:"+d+"px;background:"+i+";"}),u=weekLabel(a)+" | "+fmtUSD(l.cost);u+=o?"\nClaude "+fmtUSD(l.claudeCost||0)+"\nCodex "+fmtUSD(l.codexCost||0):", "+l.sessions+" sessions",p.appendChild(el("div",{class:"tooltip"},u)),r.appendChild(p),r.appendChild(el("div",{class:"bar-label"},weekLabel(a))),e.appendChild(r)})}var PROJ_COLORS=["#D37356","#7385FE","#047857","#e4a222","#8b5cf6","#ec4899","#14b8a6","#f97316","#6366f1","#84cc16"];function renderProjects(e,a,t,s){if(a&&a.length){var o=el("div",{class:"section"});o.appendChild(el("h2",null,"Projects"));var n=el("div",{class:"proj-wrap"}),l=0;a.forEach(function(e){l+=e.cost});var d=[],r=0,i=0;a.forEach(function(e,a){a<5?d.push({name:e.name,cost:e.cost,sessions:e.sessions,color:PROJ_COLORS[a%PROJ_COLORS.length]}):(r+=e.cost,i+=e.sessions)}),r>0&&d.push({name:"Other ("+(a.length-5)+")",cost:r,sessions:i,color:"#cbd5e1"});var c=[],p=0;d.forEach(function(e){var a=l>0?e.cost/l*100:0;c.push(e.color+" "+p.toFixed(2)+"% "+(p+a).toFixed(2)+"%"),p+=a});var u=el("div",{class:"proj-donut",style:"background:conic-gradient("+c.join(",")+");"});u.appendChild(el("div",{class:"proj-donut-hole"})),n.appendChild(u);var h=el("div",{class:"proj-legend"});if(d.forEach(function(e){var a=el("div",{class:"proj-legend-row"});a.appendChild(el("span",{class:"proj-swatch",style:"background:"+e.color})),a.appendChild(el("span",{class:"proj-legend-name"},e.name));var t=el("span",{class:"proj-legend-meta"});t.appendChild(el("span",{class:"proj-cost"},fmtUSD(e.cost))),t.appendChild(el("span",{class:"proj-sessions"},e.sessions+" sess")),a.appendChild(t),h.appendChild(a)}),a.length>5){var C=el("div",{class:"proj-more-list"});a.slice(5).forEach(function(e,a){var t=el("div",{class:"proj-more-row"});t.appendChild(el("span",{class:"proj-swatch",style:"background:#cbd5e1"})),t.appendChild(el("span",{class:"proj-legend-name"},e.name));var s=el("span",{class:"proj-legend-meta"});s.appendChild(el("span",{class:"proj-cost"},fmtUSD(e.cost))),s.appendChild(el("span",{class:"proj-sessions"},e.sessions+" sess")),t.appendChild(s),C.appendChild(t)}),C.style.display="none";var f=el("button",{class:"proj-toggle",type:"button"},"Show "+(a.length-5)+" more"),g=!1;f.addEventListener("click",function(){g=!g,C.style.display=g?"block":"none",f.textContent=g?"Show less":"Show "+(a.length-5)+" more"}),h.appendChild(f),h.appendChild(C)}n.appendChild(h),o.appendChild(n),e.appendChild(o)}}function renderPanel(e,a){var t=a.accent;e.textContent="",e.style.setProperty("--accent",t);var s=el("div",{class:"freshness-banner"}),o=el("span",{class:"date-info"});if(o.appendChild(document.createTextNode("Sessions: ")),o.appendChild(el("span",{class:"date-val"},String(a.totalSessions))),s.appendChild(o),a.badgeEls&&a.badgeEls.length){var n=el("div",{style:"display:flex;gap:6px;align-items:center;"});a.badgeEls.forEach(function(e){n.appendChild(e)}),s.appendChild(n)}e.appendChild(s);var l=a.firstDate?new Date(a.firstDate):new Date,d=Math.ceil((new Date-l)/864e5)+1,r=el("div",{class:"stats-grid"}),i=el("div",{class:"stat-card"});i.appendChild(el("div",{class:"stat-label"},"Total Est. Cost")),i.appendChild(el("div",{class:"stat-value cost"},fmtUSD(a.displayCost))),i.appendChild(el("div",{class:"stat-sub"},fullDateFromIso(a.firstDate)+" - today")),i.appendChild(el("div",{class:"stat-sub"},d+"d span, "+a.daysActive+" active")),r.appendChild(i),r.appendChild(createStatCard("Cost / Day",fmtUSD(a.costPerDay),"cost","avg across "+a.daysActive+" days")),r.appendChild(createStatCard("Cost / Session",fmtUSD(a.costPerSession),"cost",a.totalSessions+" total sessions")),r.appendChild(createStatCard("Streak",a.streak+" days")),r.appendChild(createStatCard("Messages",a.userMessages.toLocaleString())),r.appendChild(createStatCard("Output Tokens",fmt(a.outputTokens))),a.extraCards&&a.extraCards.forEach(function(e){r.appendChild(e)}),e.appendChild(r);var c=el("div",{class:"section"});c.appendChild(el("h2",null,"Daily Activity"));var p=el("div",{class:"chart-container"});a.stacked&&p.appendChild(makeLegend());var u=el("div",{class:"bar-chart"});if(renderBarChart(u,a.allDays,a.maxMsg,t,a.stacked),p.appendChild(u),c.appendChild(p),e.appendChild(c),a.weeklySorted&&a.weeklySorted.length>0){var h=el("div",{class:"section"});h.appendChild(el("h2",null,"Weekly Usage"));var C=el("div",{class:"chart-container"});a.stacked&&C.appendChild(makeLegend());var f=el("div",{class:"weekly-chart"});renderWeeklyChart(f,a.weeklySorted,a.weeklyMap,t,a.stacked),C.appendChild(f),h.appendChild(C),e.appendChild(h)}if(a.projects&&a.projects.length>0&&renderProjects(e,a.projects,t,a.stacked),a.modelUsage&&a.modelUsage.length>0){var g=el("div",{class:"section"});g.appendChild(el("h2",null,"Usage by Model"));var m=a.modelUsage[0].cost||1,v=!!a.showProviderBadge,y=el("div",{class:"model-usage-list"});a.modelUsage.forEach(function(e){var a=el("div",{class:"mu-row"}),t=el("div",{class:"mu-left"});if(t.appendChild(createModelTag(e.id)),v){var s=el("span",{class:"sub-badge "+("claude"===e.provider?"claude":"codex")});s.textContent="claude"===e.provider?"Claude":"Codex",t.appendChild(s)}a.appendChild(t);var o=el("div",{class:"mu-right"}),n=Math.max(2,e.cost/m*100),l="claude"===e.provider?CLAUDE_COLOR:CODEX_COLOR;o.appendChild(el("div",{class:"mu-bar",style:"width:"+n+"%;background:"+l+";"})),o.appendChild(el("span",{class:"mu-cost"},fmtUSD(e.cost))),a.appendChild(o),y.appendChild(a)}),g.appendChild(y),e.appendChild(g)}if(a.dailyRows&&a.dailyRows.length>0){var D=el("div",{class:"section"}),b="model"===a.dailyCostView?"model":a.stacked?"agent":"model",x=el("div",{style:"display:flex;justify-content:space-between;align-items:center;gap:10px;"});if(x.appendChild(el("h2",null,"Daily Cost")),a.stacked&&"function"==typeof a.onDailyCostViewChange){var S=el("div",{class:"daily-view-toggle"});[{id:"agent",label:"Agent"},{id:"model",label:"Model"}].forEach(function(e){var t=el("button",{class:"daily-view-btn"+(b===e.id?" active":""),"data-view":e.id,type:"button"},e.label);t.addEventListener("click",function(){b!==e.id&&a.onDailyCostViewChange(e.id)}),S.appendChild(t)}),x.appendChild(S)}D.appendChild(x);var w=el("table"),k=el("thead"),O=el("tr");O.appendChild(el("th",null,"Date")),O.appendChild(el("th",{class:"r"},"Sessions")),O.appendChild(el("th",null,"agent"===b?"Agents":"Models")),O.appendChild(el("th",{class:"r"},"Est. Cost")),k.appendChild(O),w.appendChild(k);var E=el("tbody"),M={},A={};function j(e){if(Object.prototype.hasOwnProperty.call(M,e))return M[e];var a=modelUsageKey(e);return A[a]||0}a.modelUsage&&a.modelUsage.length&&a.modelUsage.forEach(function(e){var a=e.id,t=modelUsageKey(a),s=e.cost||0;M[a]=Math.max(M[a]||0,s),A[t]=(A[t]||0)+s}),a.dailyRows.forEach(function(e){var s=el("tr");s.appendChild(el("td",null,fullDateStr(e.date))),s.appendChild(el("td",{class:"num"},String(e.sessions)));var o=el("td"),n=t,l=null;if("agent"===b&&a.stacked){var d=rowAgentCosts(e),r=[];d.claude>0&&r.push({label:"Claude",cls:"claude",cost:d.claude}),d.codex>0&&r.push({label:"Codex",cls:"codex",cost:d.codex}),r.sort(function(e,a){return e.cost!==a.cost?a.cost-e.cost:e.label.localeCompare(a.label)}),r.length?(r.forEach(function(e){var a=el("span",{class:"sub-badge "+e.cls,style:"margin-left:0;margin-right:6px;"},e.label);o.appendChild(a)}),n=d.codex>d.claude?CODEX_COLOR:CLAUDE_COLOR):o.textContent="-"}else if(e.models&&e.models.length){var i=e.models.slice().sort(function(a,t){var s=e.modelCosts||{},o=s[a]||0,n=s[t]||0;if(o!==n)return n-o;var l=j(a),d=j(t);if(l!==d)return d-l;var r=modelSortKey(a),i=modelSortKey(t);return r!==i?r-i:a.localeCompare(t)});i.length&&(l=i[0]),i.forEach(function(e){o.appendChild(createModelTag(e)),o.appendChild(document.createTextNode(" "))}),l&&(n=colorForModel(l))}else o.textContent="-";s.appendChild(o),s.appendChild(el("td",{class:"cost-cell",style:"color:"+n},fmtUSD(e.cost))),E.appendChild(s)}),w.appendChild(E),D.appendChild(w),e.appendChild(D)}if(a.pricingNote){var T=el("div",{class:"pricing-note"});T.textContent=a.pricingNote,e.appendChild(T)}}function renderNoData(e,a,t){e.textContent="";var s=el("div",{class:"no-data"});s.appendChild(el("h3",null,"No "+a+" usage data found"));var o=el("p");o.appendChild(document.createTextNode("Install ")),o.appendChild(el("a",{href:t},a)),o.appendChild(document.createTextNode(" and use it to start tracking.")),s.appendChild(o),e.appendChild(s)}function main(){var e=DATA.claude,a=DATA.codex,t=null!==e,s=null!==a,o=DATA.defaultTab||"all",n="this_month",l="agent",d=t?buildOpts(e):null,r=s?buildOpts(a):null,i=mergeOpts(d,r),c=document.getElementById("tab-bar");[{id:"all",label:"All"},{id:"claude",label:"Claude",icon:"claude.webp"},{id:"codex",label:"Codex",icon:"codex.webp"}].forEach(function(e){var a="undefined"!=typeof DATA&&DATA&&DATA.appMeta?DATA.appMeta:{},t=a.assetBase?toFileUrl(a.assetBase):"",s=[];e.icon&&t&&s.push(el("img",{class:"tab-icon",src:t+"/"+e.icon,alt:e.label+" logo"})),s.push(el("span",null,e.label));var o=el("button",{class:"tab-btn","data-tab":e.id},s);o.addEventListener("click",function(){C(e.id)}),c.appendChild(o)});var p=document.getElementById("range-select");function u(){var e=applyRange(i,n);if(e.dailyCostView=l,e.onDailyCostViewChange=function(e){l="model"===e?"model":"agent",u()},renderPanel(document.getElementById("panel-all"),e),t){var a=applyRange(d,n);a.dailyCostView="model",renderPanel(document.getElementById("panel-claude"),a)}else renderNoData(document.getElementById("panel-claude"),"Claude Code","https://code.claude.com/docs/en/overview");if(s){var o=applyRange(r,n);o.dailyCostView="model",renderPanel(document.getElementById("panel-codex"),o)}else renderNoData(document.getElementById("panel-codex"),"Codex CLI","https://developers.openai.com/codex/cli/")}function h(e){n=e,p&&p.value!==e&&(p.value=e),u()}function C(e){document.querySelectorAll(".tab-btn").forEach(function(e){e.classList.remove("active")}),document.querySelectorAll(".tab-panel").forEach(function(e){e.classList.remove("active")}),document.querySelector('[data-tab="'+e+'"]').classList.add("active"),document.getElementById("panel-"+e).classList.add("active"),history.replaceState(null,"","#"+e)}RANGE_OPTIONS.forEach(function(e){var a=el("option",{value:e.id},e.label);p.appendChild(a)}),p.addEventListener("change",function(){h(p.value)}),h(n);var f=location.hash.replace("#","");-1!==["all","claude","codex"].indexOf(f)?C(f):C(o)}renderFooter(),null!==DATA.claude||null!==DATA.codex?main():document.querySelector(".container").insertAdjacentElement("afterbegin",el("div",{class:"no-data"},"No data. Run code-usage to generate."));
</script>
</body>
</html>
