<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Code Usage Dashboard</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:#f8fafc;color:#334155;line-height:1.6}.header{border-bottom:1px solid #e2e8f0}.header-inner{max-width:1100px;margin:0 auto;padding:24px 24px 0}.header-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.header h1{font-size:24px;font-weight:700;color:#0f172a}.header .sub{font-size:13px;color:#64748b;margin-top:4px}.header .gen-time{font-size:11px;color:#94a3b8;text-align:right}.container{max-width:1100px;margin:0 auto;padding:24px}.header-controls{display:flex;justify-content:space-between;align-items:flex-end;gap:12px}.tab-bar{display:flex;gap:4px;margin:0;background:#e2e8f0;border-radius:10px 10px 0 0;padding:4px 4px 0;width:fit-content}.tab-btn{padding:8px 20px 10px;border-radius:8px 8px 0 0;border:none;background:0 0;font-size:13px;font-weight:600;color:#64748b;cursor:pointer;transition:.2s;display:inline-flex;align-items:center;gap:7px}.tab-icon{width:15px;height:15px;object-fit:contain;flex:0 0 auto}.tab-btn:hover{color:#334155}.tab-btn.active[data-tab=all]{background:#f8fafc;color:#3b82f6;box-shadow:none;border-bottom:2px solid #3b82f6}.tab-btn.active[data-tab=claude]{background:#f8fafc;color:#d37356;box-shadow:none;border-bottom:2px solid #d37356}.tab-btn.active[data-tab=codex]{background:#f8fafc;color:#7385fe;box-shadow:none;border-bottom:2px solid #7385fe}.range-control{display:flex;align-items:center;gap:8px;margin-bottom:6px}.range-label{font-size:12px;color:#64748b;font-weight:600;white-space:nowrap}.range-select{border:1px solid #cbd5e1;background:#fff;border-radius:8px;padding:6px 10px;font-size:12px;color:#0f172a;font-weight:600}.daily-view-toggle{display:inline-flex;gap:4px;background:#e2e8f0;border-radius:8px;padding:3px}.daily-view-btn{border:none;background:0 0;color:#64748b;font-size:12px;font-weight:600;padding:5px 10px;border-radius:6px;cursor:pointer}.daily-view-btn.active{background:#fff;color:#0f172a;box-shadow:0 1px 2px rgba(0,0,0,.08)}.tab-panel{display:none}.tab-panel.active{display:block}.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:28px}.stat-card{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:20px;box-shadow:0 1px 3px rgba(0,0,0,.04)}.stat-label{font-size:11px;text-transform:uppercase;letter-spacing:.05em;color:#94a3b8;margin-bottom:6px}.stat-value{font-size:28px;font-weight:700;color:#0f172a}.stat-value.cost{color:var(--accent,#d37356)}.stat-sub{font-size:12px;color:#94a3b8;margin-top:2px}.section{margin-bottom:28px}.section h2{font-size:16px;font-weight:600;color:#1e293b;margin-bottom:14px;padding-bottom:8px;border-bottom:1px solid #e2e8f0}table{width:100%;border-collapse:collapse;font-size:13px}th{text-align:left;padding:10px 14px;color:#94a3b8;font-weight:600;font-size:11px;text-transform:uppercase;letter-spacing:.05em;border-bottom:2px solid #e2e8f0}th.r{text-align:right}td{padding:10px 14px;border-bottom:1px solid #f1f5f9;color:#475569}tr:hover td{background:#f8fafc}td.num{text-align:right;font-variant-numeric:tabular-nums}td.cost-cell{font-weight:600;text-align:right;font-variant-numeric:tabular-nums}.model-tag{display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600}.model-opus{background:#f9e8e3;color:#a8533a}.model-sonnet{background:#fdf1ec;color:#c47a5f}.model-haiku{background:#d1fae5;color:#047857}.model-codex{background:#e3e8fe;color:#4a5fc7}.chart-container{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:40px 20px 20px;box-shadow:0 1px 3px rgba(0,0,0,.04);overflow:visible}.bar-chart{display:flex;align-items:flex-end;gap:3px;height:160px;position:relative}.bar-group{display:flex;flex-direction:column;align-items:center;flex:1;min-width:18px}.bar{width:100%;min-width:12px;max-width:28px;border-radius:3px 3px 0 0;transition:background .2s;cursor:pointer;position:relative}.bar:hover{filter:brightness(.9)}.bar-label{font-size:9px;color:#94a3b8;margin-top:6px;writing-mode:vertical-lr;text-orientation:mixed;transform:rotate(180deg);max-height:50px;overflow:hidden}.tooltip{display:none;position:absolute;bottom:calc(100% + 8px);left:50%;transform:translateX(-50%);background:#1e293b;color:#f1f5f9;padding:8px 12px;border-radius:6px;font-size:11px;white-space:pre-line;min-width:170px;max-width:280px;line-height:1.35;text-align:left;z-index:9999;pointer-events:none;box-shadow:0 4px 12px rgba(0,0,0,.15)}.chart-legend{display:flex;gap:14px;margin-bottom:8px;justify-content:flex-end;font-size:11px;color:#64748b}.chart-legend .swatch{display:inline-block;width:10px;height:10px;border-radius:2px;margin-right:4px;vertical-align:middle}.bar:hover .tooltip{display:block}.weekly-chart{display:flex;align-items:flex-end;gap:12px;height:160px;justify-content:center;position:relative}.weekly-chart .bar-group{display:flex;flex-direction:column;align-items:center;flex:1;max-width:120px}.weekly-chart .bar{width:100%;max-width:120px;min-width:40px;border-radius:6px 6px 0 0;transition:background .2s;cursor:pointer;position:relative}.weekly-chart .bar-label{font-size:11px;color:#64748b;margin-top:8px;writing-mode:horizontal-tb;transform:none;text-align:center;max-height:none;font-weight:500}.weekly-chart .bar-cost{font-size:11px;font-weight:600;margin-bottom:4px}.pricing-note{font-size:12px;color:#94a3b8;margin-top:16px;padding:12px;background:#fff;border-radius:8px;border:1px solid #e2e8f0}.model-usage-list{background:#fff;border:1px solid #e2e8f0;border-radius:12px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.04)}.mu-row{display:flex;align-items:center;padding:12px 16px;border-bottom:1px solid #f1f5f9}.mu-row:last-child{border-bottom:none}.mu-left{display:flex;align-items:center;gap:8px;min-width:240px}.mu-right{display:flex;align-items:center;gap:12px;flex:1}.mu-bar{height:8px;border-radius:4px;min-width:2px}.mu-cost{font-size:14px;font-weight:700;color:#0f172a;font-variant-numeric:tabular-nums;white-space:nowrap}.no-data{text-align:center;padding:80px 24px;color:#94a3b8}.no-data h3{font-size:18px;color:#64748b;margin-bottom:8px}.no-data a{color:var(--accent,#d37356)}.footer{text-align:center;margin-top:24px;padding:20px 0 8px;font-size:13px;color:#94a3b8}.footer code{background:#e2e8f0;padding:2px 6px;border-radius:4px;font-size:12px;color:#64748b}.footer a{color:#334155;text-decoration:none;font-weight:600}.footer a:hover{text-decoration:underline}.footer p{margin:4px 0}.freshness-banner{background:#fff;border:1px solid #e2e8f0;border-radius:8px;padding:12px 16px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;font-size:13px;box-shadow:0 1px 3px rgba(0,0,0,.04)}.freshness-banner .date-info{color:#64748b}.freshness-banner .date-val{color:#0f172a;font-weight:600}.sub-badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-left:6px;vertical-align:middle}.sub-badge.claude{background:#f9e8e3;color:#a8533a}.sub-badge.codex{background:#e3e8fe;color:#4a5fc7}@media (max-width:768px){.header-inner{padding:16px 16px 0}.header-controls{flex-direction:column;align-items:stretch}.tab-bar{width:100%;justify-content:space-between}.tab-btn{flex:1;text-align:center;padding:8px 8px 10px;justify-content:center}.range-control{justify-content:flex-start;margin-bottom:10px}.stats-grid{grid-template-columns:repeat(2,1fr)}.container{padding:16px}}
</style>
</head>
<body>
<div class="header">
  <div class="header-inner">
    <div class="header-top">
      <div>
        <h1>Code Usage Dashboard</h1>
        <div class="sub">Estimated API-equivalent costs from local session data</div>
      </div>
      <div class="gen-time" id="gen-time"></div>
    </div>
    <div class="header-controls">
      <div class="tab-bar" id="tab-bar"></div>
      <div class="range-control">
        <label class="range-label" for="range-select">Range</label>
        <select class="range-select" id="range-select"></select>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div id="panel-all" class="tab-panel"></div>
  <div id="panel-claude" class="tab-panel"></div>
  <div id="panel-codex" class="tab-panel"></div>
  <div class="footer">
    <p>Run <code>code-usage</code> to generate a fresh report.</p>
    <p id="footer-meta"></p>
  </div>
</div>
<script>
// DATA_PLACEHOLDER
function fmt(e){return e>=1e9?(e/1e9).toFixed(1)+"B":e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":String(e)}function fmtUSD(e){return"$"+e.toFixed(2)}function pad2(e){return e<10?"0"+e:String(e)}function localDateStr(e){return e.getFullYear()+"-"+pad2(e.getMonth()+1)+"-"+pad2(e.getDate())}function fullDateStr(e){var t=String(e||"").match(/^(\d{4})-(\d{2})-(\d{2})$/);return t?t[2]+"-"+t[3]+"-"+t[1]:String(e||"")}function fullDateFromIso(e){if(!e)return"-";var t=new Date(e);return Number.isNaN(t.getTime())?String(e):pad2(t.getMonth()+1)+"-"+pad2(t.getDate())+"-"+t.getFullYear()}function modelUsageKey(e){return String(e||"").replace(/-\d{8}$/,"")}function toFileUrl(e){var t=String(e||"").replace(/\\/g,"/");return t?0===t.indexOf("file://")||0===t.indexOf("http://")||0===t.indexOf("https://")?t:"/"===t.charAt(0)?"file://"+t:"file:///"+t:""}function providerFromModel(e){return String(e||"").startsWith("gpt-")?"codex":"claude"}function colorForModel(e){var t=String(e||"").toLowerCase();return t.startsWith("gpt-")?CODEX_COLOR:-1!==t.indexOf("haiku")?"#047857":-1!==t.indexOf("sonnet")?"#c47a5f":CLAUDE_COLOR}function rowAgentCosts(e){var t=0,a=0,s=e&&e.modelCosts?e.modelCosts:null;if(s)for(var l in s)"codex"===providerFromModel(l)?a+=s[l]||0:t+=s[l]||0;return{claude:t,codex:a}}var MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function el(e,t,a){var s=document.createElement(e);if(t)for(var l in t)"class"===l?s.className=t[l]:"style"===l?s.style.cssText=t[l]:s.setAttribute(l,t[l]);return a&&("string"==typeof a?s.textContent=a:Array.isArray(a)?a.forEach(function(e){e&&s.appendChild(e)}):s.appendChild(a)),s}function createStatCard(e,t,a,s){var l=el("div",{class:"stat-card"});return l.appendChild(el("div",{class:"stat-label"},e)),l.appendChild(el("div",{class:"stat-value"+(a?" "+a:"")},t)),s&&l.appendChild(el("div",{class:"stat-sub"},s)),l}function renderFooter(){var e=document.getElementById("footer-meta");if(e){var t="undefined"!=typeof APP_META&&APP_META?APP_META:{},a=t.authorName||"Aman",s=t.authorUrl||"https://x.com/onlyoneaman",l=t.repoUrl||"https://github.com/onlyoneaman/code-usage",n=t.packageUrl||"https://www.npmjs.com/package/code-usage",o=t.name||"code-usage",d=t.version||"";e.textContent="",e.appendChild(document.createTextNode("Made with ❤️ by ")),e.appendChild(el("a",{href:s,target:"_blank",rel:"noopener noreferrer"},a)),d&&e.appendChild(document.createTextNode(" · v"+d)),e.appendChild(document.createTextNode(" · ")),e.appendChild(el("a",{href:l,target:"_blank",rel:"noopener noreferrer"},"GitHub")),e.appendChild(document.createTextNode(" · ")),e.appendChild(el("a",{href:n,target:"_blank",rel:"noopener noreferrer"},o))}}var MODEL_ORDER=["opus-4-6","opus-4-5","opus-4-1","opus-4","sonnet-4-5","sonnet-4","sonnet-3-7","haiku-4-5","haiku-3-5","gpt-5.3","gpt-5.2","gpt-5.1","gpt-5-codex"];function modelSortKey(e){for(var t=0;t<MODEL_ORDER.length;t++)if(e.includes(MODEL_ORDER[t]))return t;return 99}function createModelTag(e){if(e.startsWith("gpt-"))return el("span",{class:"model-tag model-codex"},e);var t=e.replace("claude-","").replace(/-\d{8}$/,""),a=t.split("-");t=a[0].charAt(0).toUpperCase()+a[0].slice(1)+" "+a.slice(1).join(".");var s="model-tag model-sonnet";return e.includes("opus")?s="model-tag model-opus":e.includes("haiku")&&(s="model-tag model-haiku"),el("span",{class:s},t)}function getWeekStart(e){var t=new Date(e+"T12:00:00"),a=t.getDay(),s=0===a?6:a-1;return t.setDate(t.getDate()-s),localDateStr(t)}function weekLabel(e){var t=new Date(e+"T12:00:00"),a=new Date(t);return a.setDate(a.getDate()+6),t.getMonth()===a.getMonth()?MONTHS[t.getMonth()]+" "+t.getDate()+"-"+a.getDate():MONTHS[t.getMonth()]+" "+t.getDate()+" - "+MONTHS[a.getMonth()]+" "+a.getDate()}function sumBy(e,t){return e.reduce(function(e,a){return e+(a[t]||0)},0)}function buildOpts(e){var t=e.summary,a=e.accent,s=e.daily.length,l=s>0?t.totalCost/s:0,n=t.totalSessions>0?t.totalCost/t.totalSessions:0,o=t.firstDate?new Date(t.firstDate):new Date,d=localDateStr(new Date),r={};e.daily.forEach(function(e){r[e.date]=e});for(var i=[],c=new Date(o);localDateStr(c)<=d;){var p=localDateStr(c);i.push(r[p]||{date:p,cost:0,sessions:0,messages:0,models:[]}),c.setDate(c.getDate()+1)}var u=1;i.forEach(function(e){e.messages>u&&(u=e.messages)});var h={};e.daily.forEach(function(e){var t=getWeekStart(e.date);h[t]||(h[t]={cost:0,sessions:0}),h[t].cost+=e.cost,h[t].sessions+=e.sessions});var f=Object.keys(h).sort(),C=e.daily.slice().reverse(),g=[];e.extra&&((e.extra.linesAdded||e.extra.linesRemoved)&&g.push(createStatCard("Lines","+"+fmt(e.extra.linesAdded||0)+" / -"+fmt(e.extra.linesRemoved||0))),e.extra.filesModified&&g.push(createStatCard("Files Modified",fmt(e.extra.filesModified))));var m=[];if(e.badge){var v=el("span",{class:"sub-badge "+("claude"===e.provider?"claude":"codex")});v.textContent=e.badge,m.push(el("span",{class:"date-info"},[v]))}var y=e.models.map(function(t){return{id:t.id,cost:t.cost,provider:e.provider}}),D=y.slice().sort(function(e,t){return t.cost-e.cost});return{accent:a,displayCost:t.totalCost,daysActive:s,totalSessions:t.totalSessions,costPerDay:l,costPerSession:n,streak:t.streak,userMessages:t.totalMessages,outputTokens:t.totalOutputTokens,firstDate:t.firstDate,allDays:i,maxMsg:u,rawModels:y,modelUsage:D,showProviderBadge:!1,weeklySorted:f,weeklyMap:h,dailyRows:C,extraCards:g,badgeEls:m,pricingNote:e.pricingNote}}function mergeOpts(e,t){if(!e)return adjustAccent(t);if(!t)return adjustAccent(e);var a=e.displayCost+t.displayCost,s=e.totalSessions+t.totalSessions,l=e.userMessages+t.userMessages,n=e.outputTokens+t.outputTokens,o={},d={};e.allDays.forEach(function(e){o[e.date]=e}),t.allDays.forEach(function(e){d[e.date]=e});var r={};function i(e){e.forEach(function(e){r[e.date]||(r[e.date]={date:e.date,cost:0,sessions:0,messages:0}),r[e.date].cost+=e.cost,r[e.date].sessions+=e.sessions,r[e.date].messages+=e.messages})}i(e.allDays),i(t.allDays);var c=Object.keys(r).sort(),p=c.length?c[0]+"T00:00:00.000Z":null,u=new Date,h=localDateStr(u),f=[],C={cost:0,sessions:0,messages:0};if(c.length)for(var g=new Date(c[0]+"T12:00:00");localDateStr(g)<=h;){var m=localDateStr(g),v=r[m]||{date:m,cost:0,sessions:0,messages:0},y=o[m]||C,D=d[m]||C;v.claudeCost=y.cost||0,v.codexCost=D.cost||0,v.claudeMsg=y.messages||0,v.codexMsg=D.messages||0,v.claudeSess=y.sessions||0,v.codexSess=D.sessions||0,f.push(v),g.setDate(g.getDate()+1)}var b=1;f.forEach(function(e){e.messages>b&&(b=e.messages)});var x=f.filter(function(e){return e.sessions>0}).length,S={};f.forEach(function(e){e.sessions>0&&(S[e.date]=!0)});for(var E=0,w=new Date(u);S[localDateStr(w)];)E++,w.setDate(w.getDate()-1);var k=e.weeklyMap||{},O=t.weeklyMap||{},M={};function A(e){for(var t in e)M[t]||(M[t]={cost:0,sessions:0,claudeCost:0,codexCost:0}),M[t].cost+=e[t].cost,M[t].sessions+=e[t].sessions}for(var U in A(e.weeklyMap),A(t.weeklyMap),k)M[U]&&(M[U].claudeCost+=k[U].cost);for(var L in O)M[L]&&(M[L].codexCost+=O[L].cost);var T=Object.keys(M).sort(),_={};function R(e){e.forEach(function(e){if(_[e.date]||(_[e.date]={date:e.date,cost:0,sessions:0,messages:0,models:[],modelCosts:{}}),_[e.date].cost+=e.cost,_[e.date].sessions+=e.sessions,_[e.date].messages+=e.messages,e.modelCosts)for(var t in e.modelCosts)_[e.date].modelCosts[t]=(_[e.date].modelCosts[t]||0)+(e.modelCosts[t]||0);e.models&&e.models.forEach(function(t){-1===_[e.date].models.indexOf(t)&&_[e.date].models.push(t)})})}R(e.dailyRows),R(t.dailyRows);var N=Object.keys(_).sort().reverse().map(function(e){var t=_[e];return t.modelCosts&&(t.models=Object.keys(t.modelCosts).sort(function(e,a){var s=t.modelCosts[e]||0,l=t.modelCosts[a]||0;return s!==l?l-s:e.localeCompare(a)})),t}),P=[];function B(e,t,a){var s=el("span",{class:"date-info"}),l=el("span",{class:"sub-badge "+a});return l.textContent=e+" "+t,s.appendChild(l),s}P.push(B("Claude",e.totalSessions,"claude")),P.push(B("Codex",t.totalSessions,"codex"));var F=[].concat(e.rawModels||[]).concat(t.rawModels||[]);return F.sort(function(e,t){return t.cost-e.cost}),{accent:"#3b82f6",displayCost:a,daysActive:x,totalSessions:s,costPerDay:x>0?a/x:0,costPerSession:s>0?a/s:0,streak:E,userMessages:l,outputTokens:n,firstDate:p,allDays:f,maxMsg:b,stacked:!0,modelUsage:F,showProviderBadge:!0,weeklySorted:T,weeklyMap:M,dailyRows:N,extraCards:[],badgeEls:P,pricingNote:"Combined view across Claude and Codex. Models are sorted by estimated cost usage."}}function adjustAccent(e){var t=Object.assign({},e);return t.accent="#3b82f6",t}var RANGE_OPTIONS=[{id:"this_week",label:"This Week"},{id:"this_month",label:"This Month"},{id:"this_year",label:"This Year"},{id:"last_30_days",label:"Last 30 Days"},{id:"last_90_days",label:"Last 90 Days"},{id:"all_time",label:"All Time"}];function rangeStart(e){var t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate());if("this_week"===e){var s=a.getDay(),l=0===s?6:s-1;return a.setDate(a.getDate()-l),localDateStr(a)}return"this_month"===e?(a.setDate(1),localDateStr(a)):"this_year"===e?(a.setMonth(0,1),localDateStr(a)):"last_30_days"===e?(a.setDate(a.getDate()-29),localDateStr(a)):"last_90_days"===e?(a.setDate(a.getDate()-89),localDateStr(a)):null}function computeStreak(e){var t={};e.forEach(function(e){e.sessions>0&&(t[e.date]=!0)});for(var a=0,s=new Date;t[localDateStr(s)];)a++,s.setDate(s.getDate()-1);return a}function applyRange(e,t){if(!e)return e;if("all_time"===t){var a=Object.assign({},e);return a.rangeId=t,a}var s=rangeStart(t),l=(e.allDays||[]).filter(function(e){return e.date>=s}),n=(e.dailyRows||[]).filter(function(e){return e.date>=s}),o=sumBy(l,"cost"),d=sumBy(l,"sessions"),r=Math.max(0,e.userMessages||0),i=sumBy(e.allDays||[],"messages"),c=sumBy(l,"messages"),p=r;r>0&&i>0&&(p=Math.round(r*(c/i)));for(var u=l.filter(function(e){return e.sessions>0}).length,h=null,f=0;f<l.length;f++)if(l[f].sessions>0){h=l[f].date+"T00:00:00.000Z";break}var C=1;l.forEach(function(e){e.messages>C&&(C=e.messages)});var g={};l.forEach(function(e){var t=getWeekStart(e.date);g[t]||(g[t]={cost:0,sessions:0,claudeCost:0,codexCost:0}),g[t].cost+=e.cost||0,g[t].sessions+=e.sessions||0,g[t].claudeCost+=e.claudeCost||0,g[t].codexCost+=e.codexCost||0});var m=Object.keys(g).sort(),v=e.modelUsage&&e.modelUsage.length?e.modelUsage:e.rawModels||[],y=(e.displayCost||0)>0?o/e.displayCost:0,D=v.map(function(e){return{id:e.id,cost:(e.cost||0)*y,provider:e.provider}}).filter(function(e){return e.cost>0}).sort(function(e,t){return t.cost-e.cost}),b=Object.assign({},e,{rangeId:t,allDays:l,maxMsg:C,dailyRows:n,weeklyMap:g,weeklySorted:m,displayCost:o,totalSessions:d,userMessages:p,daysActive:u,firstDate:h,costPerDay:u>0?o/u:0,costPerSession:d>0?o/d:0,streak:computeStreak(l),modelUsage:D});if(b.stacked){var x=sumBy(l,"claudeSess"),S=sumBy(l,"codexSess"),E=[];function w(e,t,a){var s=el("span",{class:"date-info"}),l=el("span",{class:"sub-badge "+a});return l.textContent=e+" "+t,s.appendChild(l),s}E.push(w("Claude",x,"claude")),E.push(w("Codex",S,"codex")),b.badgeEls=E}return b.pricingNote="Models are sorted by estimated cost usage for this selected range.",b}var CLAUDE_COLOR="#D37356",CODEX_COLOR="#7385FE";function makeLegend(){var e=el("div",{class:"chart-legend"}),t=el("span");t.appendChild(el("span",{class:"swatch",style:"background:"+CLAUDE_COLOR})),t.appendChild(document.createTextNode("Claude")),e.appendChild(t);var a=el("span");return a.appendChild(el("span",{class:"swatch",style:"background:"+CODEX_COLOR})),a.appendChild(document.createTextNode("Codex")),e.appendChild(a),e}function renderBarChart(e,t,a,s,l){e.textContent="",t.forEach(function(t){var n=0===t.sessions,o=n?0:Math.max(4,t.messages/a*140),d=el("div",{class:"bar-group"}),r=s;if(l&&!n&&t.cost>0){var i=t.claudeCost/t.cost*100;r="linear-gradient(to top, "+CLAUDE_COLOR+" "+i+"%, "+CODEX_COLOR+" "+i+"%)"}var c=el("div",{class:"bar",style:"height:"+(n?"2":o)+"px;background:"+(n?"#e2e8f0":r)+";"}),p=fullDateStr(t.date)+" | "+fmtUSD(t.cost);p+=l?"\nClaude "+fmtUSD(t.claudeCost||0)+"\nCodex "+fmtUSD(t.codexCost||0):", "+t.sessions+" sessions",c.appendChild(el("div",{class:"tooltip"},p)),d.appendChild(c),d.appendChild(el("div",{class:"bar-label"},t.date.slice(5))),e.appendChild(d)})}function renderWeeklyChart(e,t,a,s,l){e.textContent="";var n=1;t.forEach(function(e){a[e].cost>n&&(n=a[e].cost)}),t.forEach(function(t){var o=a[t],d=Math.max(8,o.cost/n*130),r=el("div",{class:"bar-group"});r.appendChild(el("div",{class:"bar-cost",style:"color:"+s},fmtUSD(o.cost)));var i=s;if(l&&o.cost>0){var c=o.claudeCost/o.cost*100;i="linear-gradient(to top, "+CLAUDE_COLOR+" "+c+"%, "+CODEX_COLOR+" "+c+"%)"}var p=el("div",{class:"bar",style:"height:"+d+"px;background:"+i+";"}),u=weekLabel(t)+" | "+fmtUSD(o.cost);u+=l?"\nClaude "+fmtUSD(o.claudeCost||0)+"\nCodex "+fmtUSD(o.codexCost||0):", "+o.sessions+" sessions",p.appendChild(el("div",{class:"tooltip"},u)),r.appendChild(p),r.appendChild(el("div",{class:"bar-label"},weekLabel(t))),e.appendChild(r)})}function renderPanel(e,t){var a=t.accent;e.textContent="",e.style.setProperty("--accent",a);var s=el("div",{class:"freshness-banner"}),l=el("span",{class:"date-info"});if(l.appendChild(document.createTextNode("Sessions: ")),l.appendChild(el("span",{class:"date-val"},String(t.totalSessions))),s.appendChild(l),t.badgeEls&&t.badgeEls.length){var n=el("div",{style:"display:flex;gap:6px;align-items:center;"});t.badgeEls.forEach(function(e){n.appendChild(e)}),s.appendChild(n)}e.appendChild(s);var o=t.firstDate?new Date(t.firstDate):new Date,d=Math.ceil((new Date-o)/864e5)+1,r=el("div",{class:"stats-grid"}),i=el("div",{class:"stat-card"});i.appendChild(el("div",{class:"stat-label"},"Total Est. Cost")),i.appendChild(el("div",{class:"stat-value cost"},fmtUSD(t.displayCost))),i.appendChild(el("div",{class:"stat-sub"},fullDateFromIso(t.firstDate)+" - today")),i.appendChild(el("div",{class:"stat-sub"},d+"d span, "+t.daysActive+" active")),r.appendChild(i),r.appendChild(createStatCard("Cost / Day",fmtUSD(t.costPerDay),"cost","avg across "+t.daysActive+" days")),r.appendChild(createStatCard("Cost / Session",fmtUSD(t.costPerSession),"cost",t.totalSessions+" total sessions")),r.appendChild(createStatCard("Streak",t.streak+" days")),r.appendChild(createStatCard("Messages",t.userMessages.toLocaleString())),r.appendChild(createStatCard("Output Tokens",fmt(t.outputTokens))),t.extraCards&&t.extraCards.forEach(function(e){r.appendChild(e)}),e.appendChild(r);var c=el("div",{class:"section"});c.appendChild(el("h2",null,"Daily Activity"));var p=el("div",{class:"chart-container"});t.stacked&&p.appendChild(makeLegend());var u=el("div",{class:"bar-chart"});if(renderBarChart(u,t.allDays,t.maxMsg,a,t.stacked),p.appendChild(u),c.appendChild(p),e.appendChild(c),t.weeklySorted&&t.weeklySorted.length>0){var h=el("div",{class:"section"});h.appendChild(el("h2",null,"Weekly Usage"));var f=el("div",{class:"chart-container"});t.stacked&&f.appendChild(makeLegend());var C=el("div",{class:"weekly-chart"});renderWeeklyChart(C,t.weeklySorted,t.weeklyMap,a,t.stacked),f.appendChild(C),h.appendChild(f),e.appendChild(h)}if(t.modelUsage&&t.modelUsage.length>0){var g=el("div",{class:"section"});g.appendChild(el("h2",null,"Usage by Model"));var m=t.modelUsage[0].cost||1,v=!!t.showProviderBadge,y=el("div",{class:"model-usage-list"});t.modelUsage.forEach(function(e){var t=el("div",{class:"mu-row"}),a=el("div",{class:"mu-left"});if(a.appendChild(createModelTag(e.id)),v){var s=el("span",{class:"sub-badge "+("claude"===e.provider?"claude":"codex")});s.textContent="claude"===e.provider?"Claude":"Codex",a.appendChild(s)}t.appendChild(a);var l=el("div",{class:"mu-right"}),n=Math.max(2,e.cost/m*100),o="claude"===e.provider?CLAUDE_COLOR:CODEX_COLOR;l.appendChild(el("div",{class:"mu-bar",style:"width:"+n+"%;background:"+o+";"})),l.appendChild(el("span",{class:"mu-cost"},fmtUSD(e.cost))),t.appendChild(l),y.appendChild(t)}),g.appendChild(y),e.appendChild(g)}if(t.dailyRows&&t.dailyRows.length>0){var D=el("div",{class:"section"}),b="model"===t.dailyCostView?"model":t.stacked?"agent":"model",x=el("div",{style:"display:flex;justify-content:space-between;align-items:center;gap:10px;"});if(x.appendChild(el("h2",null,"Daily Cost")),t.stacked&&"function"==typeof t.onDailyCostViewChange){var S=el("div",{class:"daily-view-toggle"});[{id:"agent",label:"Agent"},{id:"model",label:"Model"}].forEach(function(e){var a=el("button",{class:"daily-view-btn"+(b===e.id?" active":""),"data-view":e.id,type:"button"},e.label);a.addEventListener("click",function(){b!==e.id&&t.onDailyCostViewChange(e.id)}),S.appendChild(a)}),x.appendChild(S)}D.appendChild(x);var E=el("table"),w=el("thead"),k=el("tr");k.appendChild(el("th",null,"Date")),k.appendChild(el("th",{class:"r"},"Sessions")),k.appendChild(el("th",null,"agent"===b?"Agents":"Models")),k.appendChild(el("th",{class:"r"},"Est. Cost")),w.appendChild(k),E.appendChild(w);var O=el("tbody"),M={},A={};function U(e){if(Object.prototype.hasOwnProperty.call(M,e))return M[e];var t=modelUsageKey(e);return A[t]||0}t.modelUsage&&t.modelUsage.length&&t.modelUsage.forEach(function(e){var t=e.id,a=modelUsageKey(t),s=e.cost||0;M[t]=Math.max(M[t]||0,s),A[a]=(A[a]||0)+s}),t.dailyRows.forEach(function(e){var s=el("tr");s.appendChild(el("td",null,fullDateStr(e.date))),s.appendChild(el("td",{class:"num"},String(e.sessions)));var l=el("td"),n=a,o=null;if("agent"===b&&t.stacked){var d=rowAgentCosts(e),r=[];d.claude>0&&r.push({label:"Claude",cls:"claude",cost:d.claude}),d.codex>0&&r.push({label:"Codex",cls:"codex",cost:d.codex}),r.sort(function(e,t){return e.cost!==t.cost?t.cost-e.cost:e.label.localeCompare(t.label)}),r.length?(r.forEach(function(e){var t=el("span",{class:"sub-badge "+e.cls,style:"margin-left:0;margin-right:6px;"},e.label);l.appendChild(t)}),n=d.codex>d.claude?CODEX_COLOR:CLAUDE_COLOR):l.textContent="-"}else if(e.models&&e.models.length){var i=e.models.slice().sort(function(t,a){var s=e.modelCosts||{},l=s[t]||0,n=s[a]||0;if(l!==n)return n-l;var o=U(t),d=U(a);if(o!==d)return d-o;var r=modelSortKey(t),i=modelSortKey(a);return r!==i?r-i:t.localeCompare(a)});i.length&&(o=i[0]),i.forEach(function(e){l.appendChild(createModelTag(e)),l.appendChild(document.createTextNode(" "))}),o&&(n=colorForModel(o))}else l.textContent="-";s.appendChild(l),s.appendChild(el("td",{class:"cost-cell",style:"color:"+n},fmtUSD(e.cost))),O.appendChild(s)}),E.appendChild(O),D.appendChild(E),e.appendChild(D)}if(t.pricingNote){var L=el("div",{class:"pricing-note"});L.textContent=t.pricingNote,e.appendChild(L)}}function renderNoData(e,t,a){e.textContent="";var s=el("div",{class:"no-data"});s.appendChild(el("h3",null,"No "+t+" usage data found"));var l=el("p");l.appendChild(document.createTextNode("Install ")),l.appendChild(el("a",{href:a},t)),l.appendChild(document.createTextNode(" and use it to start tracking.")),s.appendChild(l),e.appendChild(s)}function main(){var e=null!==CLAUDE,t=null!==CODEX,a="undefined"!=typeof DEFAULT_TAB?DEFAULT_TAB:"all",s="this_month",l="agent",n=e?buildOpts(CLAUDE):null,o=t?buildOpts(CODEX):null,d=mergeOpts(n,o),r=document.getElementById("tab-bar");[{id:"all",label:"All"},{id:"claude",label:"Claude",icon:"claude.webp"},{id:"codex",label:"Codex",icon:"codex.webp"}].forEach(function(e){var t="undefined"!=typeof APP_META&&APP_META?APP_META:{},a=t.assetBase?toFileUrl(t.assetBase):"",s=[];e.icon&&a&&s.push(el("img",{class:"tab-icon",src:a+"/"+e.icon,alt:e.label+" logo"})),s.push(el("span",null,e.label));var l=el("button",{class:"tab-btn","data-tab":e.id},s);l.addEventListener("click",function(){u(e.id)}),r.appendChild(l)});var i=document.getElementById("range-select");function c(){var a=applyRange(d,s);if(a.dailyCostView=l,a.onDailyCostViewChange=function(e){l="model"===e?"model":"agent",c()},renderPanel(document.getElementById("panel-all"),a),e){var r=applyRange(n,s);r.dailyCostView="model",renderPanel(document.getElementById("panel-claude"),r)}else renderNoData(document.getElementById("panel-claude"),"Claude Code","https://code.claude.com/docs/en/overview");if(t){var i=applyRange(o,s);i.dailyCostView="model",renderPanel(document.getElementById("panel-codex"),i)}else renderNoData(document.getElementById("panel-codex"),"Codex CLI","https://developers.openai.com/codex/cli/")}function p(e){s=e,i&&i.value!==e&&(i.value=e),c()}function u(e){document.querySelectorAll(".tab-btn").forEach(function(e){e.classList.remove("active")}),document.querySelectorAll(".tab-panel").forEach(function(e){e.classList.remove("active")}),document.querySelector('[data-tab="'+e+'"]').classList.add("active"),document.getElementById("panel-"+e).classList.add("active"),history.replaceState(null,"","#"+e)}RANGE_OPTIONS.forEach(function(e){var t=el("option",{value:e.id},e.label);i.appendChild(t)}),i.addEventListener("change",function(){p(i.value)}),p(s);var h=location.hash.replace("#","");-1!==["all","claude","codex"].indexOf(h)?u(h):u(a)}renderFooter(),null!==CLAUDE||null!==CODEX?main():document.querySelector(".container").insertAdjacentElement("afterbegin",el("div",{class:"no-data"},"No data. Run code-usage to generate."));
</script>
</body>
</html>
